{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 88, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/Acer/Desktop/8-preact-end-main/app/%28main%29/menagers/page.tsx"],"sourcesContent":["\"use client\";\n\nimport { useState } from \"react\";\nimport axios from \"axios\";\nimport Cookies from \"js-cookie\";\nimport { Pencil, Trash2, MoreHorizontal, X, Loader2 } from \"lucide-react\";\nimport { useQuery, useMutation, useQueryClient } from \"@tanstack/react-query\";\n\ninterface Manager {\n  _id: string;\n  first_name: string;\n  last_name: string;\n  email: string;\n  role: string;\n  status: string;\n}\n\nconst SkeletonRow = () => (\n  <tr className=\"border-t border-zinc-200 dark:border-zinc-800 animate-pulse\">\n    <td className=\"p-4\">\n      <div className=\"h-4 bg-zinc-200 dark:bg-zinc-800 rounded w-3/4\"></div>\n    </td>\n    <td className=\"p-4\">\n      <div className=\"h-4 bg-zinc-200 dark:bg-zinc-800 rounded w-full\"></div>\n    </td>\n    <td className=\"p-4\">\n      <div className=\"h-4 bg-zinc-200 dark:bg-zinc-800 rounded w-12\"></div>\n    </td>\n    <td className=\"p-4\">\n      <div className=\"h-4 bg-zinc-200 dark:bg-zinc-800 rounded w-16\"></div>\n    </td>\n    <td className=\"p-4 text-right\">\n      <div className=\"h-8 w-16 bg-zinc-200 dark:bg-zinc-800 rounded ml-auto\"></div>\n    </td>\n  </tr>\n);\n\nconst Menagers = () => {\n  const queryClient = useQueryClient();\n  const [activeMenu, setActiveMenu] = useState<string | null>(null);\n  const [isEditModalOpen, setIsEditModalOpen] = useState(false);\n  const [selectedManager, setSelectedManager] = useState<Manager | null>(null);\n  const [editFormData, setEditFormData] = useState({\n    first_name: \"\",\n    last_name: \"\",\n    email: \"\",\n  });\n\n  const BASE_URL = process.env.NEXT_PUBLIC_BASE_URL;\n  const token = Cookies.get(\"token\");\n\n  const { data: managers = [], isLoading } = useQuery({\n    queryKey: [\"managers\"],\n    queryFn: async () => {\n      if (!BASE_URL || !token) return [];\n      const response = await axios.get(`${BASE_URL}/api/staff/all-managers`, {\n        headers: { Authorization: `Bearer ${token}` },\n      });\n      const resData = response.data;\n      return Array.isArray(resData) ? resData : resData?.data || [];\n    },\n    enabled: !!token && !!BASE_URL,\n  });\n\n  const updateMutation = useMutation({\n    mutationFn: async (payload: any) => {\n      return axios.post(`${BASE_URL}/api/staff/edited-manager`, payload, {\n        headers: {\n          Authorization: `Bearer ${token}`,\n          \"Content-Type\": \"application/json\",\n        },\n      });\n    },\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: [\"managers\"] });\n      setIsEditModalOpen(false);\n      alert(\"Muvaffaqiyatli saqlandi!\");\n    },\n    onError: (err: any) => {\n      alert(err.response?.data?.message || \"Tahrirlashda xatolik\");\n    },\n  });\n\n  const deleteMutation = useMutation({\n    mutationFn: async (id: string) => {\n      return axios.delete(`${BASE_URL}/api/staff/deleted-admin`, {\n        headers: { Authorization: `Bearer ${token}` },\n        data: { _id: id },\n      });\n    },\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: [\"managers\"] });\n      setActiveMenu(null);\n    },\n    onError: () => {\n      alert(\"Xatolik yuz berdi\");\n    },\n  });\n\n  const handleEditClick = (manager: Manager) => {\n    setSelectedManager(manager);\n    setEditFormData({\n      first_name: manager.first_name,\n      last_name: manager.last_name,\n      email: manager.email,\n    });\n    setIsEditModalOpen(true);\n    setActiveMenu(null);\n  };\n\n  const handleUpdateManager = (e: React.FormEvent) => {\n    e.preventDefault();\n    if (!selectedManager) return;\n\n    updateMutation.mutate({\n      _id: selectedManager._id,\n      first_name: editFormData.first_name,\n      last_name: editFormData.last_name,\n      email: editFormData.email,\n      status: selectedManager.status,\n    });\n  };\n\n  const handleDelete = (id: string) => {\n    if (confirm(\"O'chirmoqchimisiz?\")) {\n      deleteMutation.mutate(id);\n    }\n  };\n\n  return (\n    <div className=\"w-full p-3 sm:p-6 min-h-screen text-foreground\">\n      <div className=\"flex justify-between items-center mb-6\">\n        <h1 className=\"text-xl sm:text-2xl font-bold tracking-tight\">\n          Menejerlar ro'yxati\n        </h1>\n      </div>\n\n      <div className=\"w-full overflow-x-auto border border-zinc-800 rounded-xl text-card-foreground shadow-sm \">\n        <table className=\"w-full text-left min-w-[500px] sm:min-w-full\">\n          <thead className=\"text-[10px] sm:text-xs uppercase text-muted-foreground font-medium border-b border-zinc-800\">\n            <tr>\n              <th className=\"p-3 sm:p-4\">Ism</th>\n              <th className=\"p-3 sm:p-4\">Familiya</th>\n              <th className=\"p-3 sm:p-4\">Email</th>\n              <th className=\"p-3 sm:p-4 text-right\">Amallar</th>\n            </tr>\n          </thead>\n\n          <tbody className=\"text-xs sm:text-sm\">\n            {isLoading\n              ? [...Array(10)].map((_, i) => <SkeletonRow key={i} />)\n              : managers.map((item: Manager) => (\n                  <tr\n                    key={item._id}\n                    className=\"border-t border-zinc-800 hover:bg-muted/50 transition-colors\"\n                  >\n                    <td className=\"p-3 sm:p-4\">{item.first_name}</td>\n                    <td className=\"p-3 sm:p-4\">{item.last_name}</td>\n                    <td className=\"p-3 sm:p-4 text-muted-foreground truncate max-w-[120px] sm:max-w-none\">\n                      {item.email}\n                    </td>\n                    <td className=\"p-3 sm:p-4 text-right relative\">\n                      <button\n                        onClick={() =>\n                          setActiveMenu(\n                            activeMenu === item._id ? null : item._id,\n                          )\n                        }\n                        className=\"p-2 hover:bg-muted rounded-md transition-colors inline-flex items-center justify-center\"\n                      >\n                        <MoreHorizontal size={18} />\n                      </button>\n\n                      {activeMenu === item._id && (\n                        <>\n                          <div\n                            className=\"fixed inset-0 z-40\"\n                            onClick={() => setActiveMenu(null)}\n                          />\n                          <div className=\"absolute right-4 mt-2 w-32 sm:w-40 border bg-popover text-popover-foreground border-zinc-800 rounded-md z-50 shadow-lg overflow-hidden text-left animate-in fade-in zoom-in-95 duration-100\">\n                            <button\n                              className=\"w-full px-3 py-2 text-[12px] sm:text-sm flex items-center gap-2 hover:bg-muted transition-colors border-b border-zinc-800\"\n                              onClick={() => handleEditClick(item)}\n                            >\n                              <Pencil size={14} /> Tahrirlash\n                            </button>\n                            <button\n                              onClick={() => handleDelete(item._id)}\n                              className=\"w-full px-3 py-2 text-[12px] sm:text-sm flex items-center gap-2 hover:bg-destructive/10 text-destructive transition-colors\"\n                            >\n                              <Trash2 size={14} /> O'chirish\n                            </button>\n                          </div>\n                        </>\n                      )}\n                    </td>\n                  </tr>\n                ))}\n          </tbody>\n        </table>\n      </div>\n\n      {isEditModalOpen && (\n        <div className=\"fixed inset-0 flex items-center justify-center z-[200] backdrop-blur-sm p-4\">\n          <div className=\"bg-background text-foreground p-5 sm:p-6 rounded-lg w-full max-w-[280px] xs:max-w-md border border-zinc-800 shadow-xl animate-in fade-in zoom-in duration-200\">\n            <div className=\"flex justify-between items-center mb-6\">\n              <h2 className=\"text-base sm:text-lg font-semibold tracking-tight\">\n                Menejerni tahrirlash\n              </h2>\n              <button\n                onClick={() => setIsEditModalOpen(false)}\n                className=\"text-muted-foreground hover:text-foreground transition-colors\"\n              >\n                <X size={20} />\n              </button>\n            </div>\n\n            <form\n              onSubmit={handleUpdateManager}\n              className=\"flex flex-col gap-4\"\n            >\n              <div className=\"space-y-1.5\">\n                <label className=\"text-[12px] sm:text-sm font-medium leading-none text-muted-foreground\">\n                  Ism\n                </label>\n                <input\n                  required\n                  className=\"w-full border border-zinc-800 p-2 sm:p-2.5 rounded-md text-sm outline-none focus:ring-2 focus:ring-ring transition-all\"\n                  value={editFormData.first_name}\n                  onChange={(e) =>\n                    setEditFormData({\n                      ...editFormData,\n                      first_name: e.target.value,\n                    })\n                  }\n                />\n              </div>\n\n              <div className=\"space-y-1.5\">\n                <label className=\"text-[12px] sm:text-sm font-medium leading-none text-muted-foreground\">\n                  Familiya\n                </label>\n                <input\n                  required\n                  className=\"w-full border border-zinc-800 p-2 sm:p-2.5 rounded-md text-sm outline-none focus:ring-2 focus:ring-ring transition-all\"\n                  value={editFormData.last_name}\n                  onChange={(e) =>\n                    setEditFormData({\n                      ...editFormData,\n                      last_name: e.target.value,\n                    })\n                  }\n                />\n              </div>\n\n              <div className=\"space-y-1.5\">\n                <label className=\"text-[12px]  sm:text-sm font-medium leading-none text-muted-foreground\">\n                  Email\n                </label>\n                <input\n                  required\n                  type=\"email\"\n                  className=\"w-full  border border-zinc-800 p-2 sm:p-2.5 rounded-md text-sm outline-none opacity-60 cursor-not-allowed\"\n                  value={editFormData.email}\n                  disabled\n                />\n              </div>\n\n              <div className=\"flex flex-col sm:flex-row gap-2 sm:gap-3 mt-4\">\n                <button\n                  type=\"button\"\n                  onClick={() => setIsEditModalOpen(false)}\n                  className=\"order-2 sm:order-1 flex-1 bg-secondary text-secondary-foreground hover:bg-secondary/80 py-2 sm:py-2.5 rounded-md text-sm font-medium transition-colors border border-zinc-800\"\n                >\n                  Bekor qilish\n                </button>\n                <button\n                  type=\"submit\"\n                  disabled={updateMutation.isPending}\n                  className=\"order-1 sm:order-2 flex-1 bg-primary text-primary-foreground hover:bg-primary/90 py-2 sm:py-2.5 rounded-md text-sm font-medium transition-colors shadow-sm flex items-center justify-center gap-2\"\n                >\n                  {updateMutation.isPending && (\n                    <Loader2 size={16} className=\"animate-spin\" />\n                  )}\n                  Saqlash\n                </button>\n              </div>\n            </form>\n          </div>\n        </div>\n      )}\n    </div>\n  );\n};\n\nexport default Menagers;\n"],"names":[],"mappings":";;;;;AAEA;AACA;AACA;AACA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AANA;;;;;;;AAiBA,MAAM,cAAc,kBAClB,8OAAC;QAAG,WAAU;;0BACZ,8OAAC;gBAAG,WAAU;0BACZ,cAAA,8OAAC;oBAAI,WAAU;;;;;;;;;;;0BAEjB,8OAAC;gBAAG,WAAU;0BACZ,cAAA,8OAAC;oBAAI,WAAU;;;;;;;;;;;0BAEjB,8OAAC;gBAAG,WAAU;0BACZ,cAAA,8OAAC;oBAAI,WAAU;;;;;;;;;;;0BAEjB,8OAAC;gBAAG,WAAU;0BACZ,cAAA,8OAAC;oBAAI,WAAU;;;;;;;;;;;0BAEjB,8OAAC;gBAAG,WAAU;0BACZ,cAAA,8OAAC;oBAAI,WAAU;;;;;;;;;;;;;;;;;AAKrB,MAAM,WAAW;IACf,MAAM,cAAc,IAAA,wMAAc;IAClC,MAAM,CAAC,YAAY,cAAc,GAAG,IAAA,iNAAQ,EAAgB;IAC5D,MAAM,CAAC,iBAAiB,mBAAmB,GAAG,IAAA,iNAAQ,EAAC;IACvD,MAAM,CAAC,iBAAiB,mBAAmB,GAAG,IAAA,iNAAQ,EAAiB;IACvE,MAAM,CAAC,cAAc,gBAAgB,GAAG,IAAA,iNAAQ,EAAC;QAC/C,YAAY;QACZ,WAAW;QACX,OAAO;IACT;IAEA,MAAM;IACN,MAAM,QAAQ,gKAAO,CAAC,GAAG,CAAC;IAE1B,MAAM,EAAE,MAAM,WAAW,EAAE,EAAE,SAAS,EAAE,GAAG,IAAA,uLAAQ,EAAC;QAClD,UAAU;YAAC;SAAW;QACtB,SAAS;YACP,IAAI,CAAC,YAAY,CAAC,OAAO,OAAO,EAAE;YAClC,MAAM,WAAW,MAAM,gJAAK,CAAC,GAAG,CAAC,GAAG,SAAS,uBAAuB,CAAC,EAAE;gBACrE,SAAS;oBAAE,eAAe,CAAC,OAAO,EAAE,OAAO;gBAAC;YAC9C;YACA,MAAM,UAAU,SAAS,IAAI;YAC7B,OAAO,MAAM,OAAO,CAAC,WAAW,UAAU,SAAS,QAAQ,EAAE;QAC/D;QACA,SAAS,CAAC,CAAC,SAAS,CAAC,CAAC;IACxB;IAEA,MAAM,iBAAiB,IAAA,6LAAW,EAAC;QACjC,YAAY,OAAO;YACjB,OAAO,gJAAK,CAAC,IAAI,CAAC,GAAG,SAAS,yBAAyB,CAAC,EAAE,SAAS;gBACjE,SAAS;oBACP,eAAe,CAAC,OAAO,EAAE,OAAO;oBAChC,gBAAgB;gBAClB;YACF;QACF;QACA,WAAW;YACT,YAAY,iBAAiB,CAAC;gBAAE,UAAU;oBAAC;iBAAW;YAAC;YACvD,mBAAmB;YACnB,MAAM;QACR;QACA,SAAS,CAAC;YACR,MAAM,IAAI,QAAQ,EAAE,MAAM,WAAW;QACvC;IACF;IAEA,MAAM,iBAAiB,IAAA,6LAAW,EAAC;QACjC,YAAY,OAAO;YACjB,OAAO,gJAAK,CAAC,MAAM,CAAC,GAAG,SAAS,wBAAwB,CAAC,EAAE;gBACzD,SAAS;oBAAE,eAAe,CAAC,OAAO,EAAE,OAAO;gBAAC;gBAC5C,MAAM;oBAAE,KAAK;gBAAG;YAClB;QACF;QACA,WAAW;YACT,YAAY,iBAAiB,CAAC;gBAAE,UAAU;oBAAC;iBAAW;YAAC;YACvD,cAAc;QAChB;QACA,SAAS;YACP,MAAM;QACR;IACF;IAEA,MAAM,kBAAkB,CAAC;QACvB,mBAAmB;QACnB,gBAAgB;YACd,YAAY,QAAQ,UAAU;YAC9B,WAAW,QAAQ,SAAS;YAC5B,OAAO,QAAQ,KAAK;QACtB;QACA,mBAAmB;QACnB,cAAc;IAChB;IAEA,MAAM,sBAAsB,CAAC;QAC3B,EAAE,cAAc;QAChB,IAAI,CAAC,iBAAiB;QAEtB,eAAe,MAAM,CAAC;YACpB,KAAK,gBAAgB,GAAG;YACxB,YAAY,aAAa,UAAU;YACnC,WAAW,aAAa,SAAS;YACjC,OAAO,aAAa,KAAK;YACzB,QAAQ,gBAAgB,MAAM;QAChC;IACF;IAEA,MAAM,eAAe,CAAC;QACpB,IAAI,QAAQ,uBAAuB;YACjC,eAAe,MAAM,CAAC;QACxB;IACF;IAEA,qBACE,8OAAC;QAAI,WAAU;;0BACb,8OAAC;gBAAI,WAAU;0BACb,cAAA,8OAAC;oBAAG,WAAU;8BAA+C;;;;;;;;;;;0BAK/D,8OAAC;gBAAI,WAAU;0BACb,cAAA,8OAAC;oBAAM,WAAU;;sCACf,8OAAC;4BAAM,WAAU;sCACf,cAAA,8OAAC;;kDACC,8OAAC;wCAAG,WAAU;kDAAa;;;;;;kDAC3B,8OAAC;wCAAG,WAAU;kDAAa;;;;;;kDAC3B,8OAAC;wCAAG,WAAU;kDAAa;;;;;;kDAC3B,8OAAC;wCAAG,WAAU;kDAAwB;;;;;;;;;;;;;;;;;sCAI1C,8OAAC;4BAAM,WAAU;sCACd,YACG;mCAAI,MAAM;6BAAI,CAAC,GAAG,CAAC,CAAC,GAAG,kBAAM,8OAAC,iBAAiB;;;;gFAC/C,SAAS,GAAG,CAAC,CAAC,qBACZ,8OAAC;oCAEC,WAAU;;sDAEV,8OAAC;4CAAG,WAAU;sDAAc,KAAK,UAAU;;;;;;sDAC3C,8OAAC;4CAAG,WAAU;sDAAc,KAAK,SAAS;;;;;;sDAC1C,8OAAC;4CAAG,WAAU;sDACX,KAAK,KAAK;;;;;;sDAEb,8OAAC;4CAAG,WAAU;;8DACZ,8OAAC;oDACC,SAAS,IACP,cACE,eAAe,KAAK,GAAG,GAAG,OAAO,KAAK,GAAG;oDAG7C,WAAU;8DAEV,cAAA,8OAAC,kOAAc;wDAAC,MAAM;;;;;;;;;;;gDAGvB,eAAe,KAAK,GAAG,kBACtB;;sEACE,8OAAC;4DACC,WAAU;4DACV,SAAS,IAAM,cAAc;;;;;;sEAE/B,8OAAC;4DAAI,WAAU;;8EACb,8OAAC;oEACC,WAAU;oEACV,SAAS,IAAM,gBAAgB;;sFAE/B,8OAAC,gNAAM;4EAAC,MAAM;;;;;;wEAAM;;;;;;;8EAEtB,8OAAC;oEACC,SAAS,IAAM,aAAa,KAAK,GAAG;oEACpC,WAAU;;sFAEV,8OAAC,oNAAM;4EAAC,MAAM;;;;;;wEAAM;;;;;;;;;;;;;;;;;;;;;;mCArCzB,KAAK,GAAG;;;;;;;;;;;;;;;;;;;;;YAiD1B,iCACC,8OAAC;gBAAI,WAAU;0BACb,cAAA,8OAAC;oBAAI,WAAU;;sCACb,8OAAC;4BAAI,WAAU;;8CACb,8OAAC;oCAAG,WAAU;8CAAoD;;;;;;8CAGlE,8OAAC;oCACC,SAAS,IAAM,mBAAmB;oCAClC,WAAU;8CAEV,cAAA,8OAAC,iMAAC;wCAAC,MAAM;;;;;;;;;;;;;;;;;sCAIb,8OAAC;4BACC,UAAU;4BACV,WAAU;;8CAEV,8OAAC;oCAAI,WAAU;;sDACb,8OAAC;4CAAM,WAAU;sDAAwE;;;;;;sDAGzF,8OAAC;4CACC,QAAQ;4CACR,WAAU;4CACV,OAAO,aAAa,UAAU;4CAC9B,UAAU,CAAC,IACT,gBAAgB;oDACd,GAAG,YAAY;oDACf,YAAY,EAAE,MAAM,CAAC,KAAK;gDAC5B;;;;;;;;;;;;8CAKN,8OAAC;oCAAI,WAAU;;sDACb,8OAAC;4CAAM,WAAU;sDAAwE;;;;;;sDAGzF,8OAAC;4CACC,QAAQ;4CACR,WAAU;4CACV,OAAO,aAAa,SAAS;4CAC7B,UAAU,CAAC,IACT,gBAAgB;oDACd,GAAG,YAAY;oDACf,WAAW,EAAE,MAAM,CAAC,KAAK;gDAC3B;;;;;;;;;;;;8CAKN,8OAAC;oCAAI,WAAU;;sDACb,8OAAC;4CAAM,WAAU;sDAAyE;;;;;;sDAG1F,8OAAC;4CACC,QAAQ;4CACR,MAAK;4CACL,WAAU;4CACV,OAAO,aAAa,KAAK;4CACzB,QAAQ;;;;;;;;;;;;8CAIZ,8OAAC;oCAAI,WAAU;;sDACb,8OAAC;4CACC,MAAK;4CACL,SAAS,IAAM,mBAAmB;4CAClC,WAAU;sDACX;;;;;;sDAGD,8OAAC;4CACC,MAAK;4CACL,UAAU,eAAe,SAAS;4CAClC,WAAU;;gDAET,eAAe,SAAS,kBACvB,8OAAC,4NAAO;oDAAC,MAAM;oDAAI,WAAU;;;;;;gDAC7B;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAUpB;uCAEe"}}]
}