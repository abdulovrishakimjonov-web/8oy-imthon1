{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 46, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/Acer/Desktop/8-preact-end-main/app/api/auth/sign-in/route.ts"],"sourcesContent":["import { NextResponse } from \"next/server\";\n\nexport async function POST(req: Request) {\n  try {\n    const body = await req.json();\n    const backendRes = await fetch(\n      `${process.env.NEXT_PUBLIC_BASE_URL}/api/auth/sign-in`,\n      {\n        method: \"POST\",\n        headers: { \"Content-Type\": \"application/json\" },\n        body: JSON.stringify(body),\n      },\n    );\n\n    const result = await backendRes.json();\n\n    if (!backendRes.ok) {\n      return NextResponse.json(\n        { message: result.message || \"Xato!\" },\n        { status: backendRes.status },\n      );\n    }\n\n    const userData = result.data;\n    const token = userData?.token;\n\n    if (!token) {\n      return NextResponse.json({ message: \"Token topilmadi\" }, { status: 401 });\n    }\n\n    const response = NextResponse.json({\n      success: true,\n      user: userData,\n      token,\n    });\n\n    response.cookies.set(\"token\", token, {\n      httpOnly: false,\n      secure: process.env.NODE_ENV === \"production\",\n      path: \"/\",\n      maxAge: 60 * 60 * 24 * 7,\n    });\n\n    if (userData) {\n      const miniUser = {\n        _id: userData._id,\n        role: userData.role,\n        first_name: userData.first_name,\n        last_name: userData.last_name,\n        email: userData.email,\n        image: userData.image,\n      };\n\n      response.cookies.set(\"user\", JSON.stringify(miniUser), {\n        httpOnly: false,\n        path: \"/\",\n        maxAge: 60 * 60 * 24 * 7,\n      });\n    }\n\n    return response;\n  } catch (error) {\n    console.error(\"Login Error:\", error);\n    return NextResponse.json({ message: \"Server xatosi\" }, { status: 500 });\n  }\n}\n"],"names":[],"mappings":";;;;AAAA;;AAEO,eAAe,KAAK,GAAY;IACrC,IAAI;QACF,MAAM,OAAO,MAAM,IAAI,IAAI;QAC3B,MAAM,aAAa,MAAM,MACvB,sEAAoC,iBAAiB,CAAC,EACtD;YACE,QAAQ;YACR,SAAS;gBAAE,gBAAgB;YAAmB;YAC9C,MAAM,KAAK,SAAS,CAAC;QACvB;QAGF,MAAM,SAAS,MAAM,WAAW,IAAI;QAEpC,IAAI,CAAC,WAAW,EAAE,EAAE;YAClB,OAAO,gJAAY,CAAC,IAAI,CACtB;gBAAE,SAAS,OAAO,OAAO,IAAI;YAAQ,GACrC;gBAAE,QAAQ,WAAW,MAAM;YAAC;QAEhC;QAEA,MAAM,WAAW,OAAO,IAAI;QAC5B,MAAM,QAAQ,UAAU;QAExB,IAAI,CAAC,OAAO;YACV,OAAO,gJAAY,CAAC,IAAI,CAAC;gBAAE,SAAS;YAAkB,GAAG;gBAAE,QAAQ;YAAI;QACzE;QAEA,MAAM,WAAW,gJAAY,CAAC,IAAI,CAAC;YACjC,SAAS;YACT,MAAM;YACN;QACF;QAEA,SAAS,OAAO,CAAC,GAAG,CAAC,SAAS,OAAO;YACnC,UAAU;YACV,QAAQ,oDAAyB;YACjC,MAAM;YACN,QAAQ,KAAK,KAAK,KAAK;QACzB;QAEA,IAAI,UAAU;YACZ,MAAM,WAAW;gBACf,KAAK,SAAS,GAAG;gBACjB,MAAM,SAAS,IAAI;gBACnB,YAAY,SAAS,UAAU;gBAC/B,WAAW,SAAS,SAAS;gBAC7B,OAAO,SAAS,KAAK;gBACrB,OAAO,SAAS,KAAK;YACvB;YAEA,SAAS,OAAO,CAAC,GAAG,CAAC,QAAQ,KAAK,SAAS,CAAC,WAAW;gBACrD,UAAU;gBACV,MAAM;gBACN,QAAQ,KAAK,KAAK,KAAK;YACzB;QACF;QAEA,OAAO;IACT,EAAE,OAAO,OAAO;QACd,QAAQ,KAAK,CAAC,gBAAgB;QAC9B,OAAO,gJAAY,CAAC,IAAI,CAAC;YAAE,SAAS;QAAgB,GAAG;YAAE,QAAQ;QAAI;IACvE;AACF"}}]
}